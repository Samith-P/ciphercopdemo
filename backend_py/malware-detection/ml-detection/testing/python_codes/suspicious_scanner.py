#!/usr/bin/env python3
"""
Suspicious File Scanner - Potentially flagged as malware
This program exhibits suspicious behavior patterns that might trigger malware detection.
"""

import os
import sys
import socket
import subprocess
import threading
import time
import random

def suspicious_network_activity():
    """Simulates network scanning behavior"""
    print("Scanning network ports...")
    for port in [21, 22, 23, 25, 53, 80, 110, 443, 993, 995]:
        try:
            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock.settimeout(0.1)
            result = sock.connect_ex(('127.0.0.1', port))
            if result == 0:
                print(f"Port {port}: Open")
            sock.close()
        except:
            pass

def suspicious_file_operations():
    """Simulates suspicious file system operations"""
    print("Performing file system operations...")
    
    # Create temporary files in system directories
    temp_files = []
    for i in range(5):
        try:
            temp_file = f"temp_file_{random.randint(1000, 9999)}.tmp"
            with open(temp_file, 'w') as f:
                f.write("Temporary data for testing")
            temp_files.append(temp_file)
        except:
            pass
    
    time.sleep(1)
    
    # Clean up
    for temp_file in temp_files:
        try:
            os.remove(temp_file)
        except:
            pass

def suspicious_process_operations():
    """Simulates process enumeration"""
    print("Enumerating system processes...")
    try:
        if sys.platform == "win32":
            subprocess.run(["tasklist"], capture_output=True, text=True)
        else:
            subprocess.run(["ps", "aux"], capture_output=True, text=True)
    except:
        pass

def suspicious_registry_access():
    """Simulates registry access (Windows only)"""
    if sys.platform == "win32":
        print("Accessing system registry...")
        try:
            subprocess.run(["reg", "query", "HKEY_LOCAL_MACHINE\\SOFTWARE"], 
                         capture_output=True, text=True)
        except:
            pass

def main():
    print("=== Suspicious Scanner v1.0 ===")
    print("WARNING: This program exhibits behavior patterns that may trigger malware detection!")
    print("This is for testing purposes only.")
    
    # Multiple threads performing suspicious activities
    threads = [
        threading.Thread(target=suspicious_network_activity),
        threading.Thread(target=suspicious_file_operations),
        threading.Thread(target=suspicious_process_operations),
        threading.Thread(target=suspicious_registry_access)
    ]
    
    for thread in threads:
        thread.start()
        time.sleep(0.5)
    
    for thread in threads:
        thread.join()
    
    print("Scan complete!")

if __name__ == "__main__":
    main()

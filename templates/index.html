<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Clone Detection System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { padding: 2rem; background: #f8f9fa; }
    .result-card { margin-top: 2rem; }
    .score { font-size: 1.5rem; font-weight: bold; }
    .clean { color: green; }
    .suspicious { color: orange; }
    .clone { color: red; }
    pre { background: #eee; padding: 0.5rem; border-radius: 4px; }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="mb-4">üïµÔ∏è‚Äç‚ôÇÔ∏è Clone Detection System</h1>
    <form id="analyzeForm" class="card p-4 shadow-sm">
      <div class="mb-3">
        <label for="url" class="form-label">Website URL</label>
        <input type="url" class="form-control" id="url" name="url" placeholder="https://example.com">
      </div>
      <div class="mb-3">
        <label for="screenshot" class="form-label">Upload Screenshot (optional)</label>
        <input type="file" class="form-control" id="screenshot" name="screenshot" accept="image/*">
      </div>
      <button type="submit" class="btn btn-primary">Analyze</button>
    </form>

    <div id="result" class="result-card"></div>
  </div>

  <script>
    const form = document.getElementById("analyzeForm");
    const resultDiv = document.getElementById("result");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      resultDiv.innerHTML = "<div class='alert alert-info'>Analyzing...</div>";

      const formData = new FormData(form);
      const res = await fetch("/analyze", { method: "POST", body: formData });
      const data = await res.json();

      let badgeClass = "secondary", decisionText = "";
      if (data.decision === "clean") { badgeClass = "success"; decisionText = "üü¢ Clean"; }
      else if (data.decision === "suspicious") { badgeClass = "warning"; decisionText = "üü† Suspicious"; }
      else if (data.decision === "clone") { badgeClass = "danger"; decisionText = "üî¥ Clone"; }

      resultDiv.innerHTML = `
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">
              Result: <span class="badge bg-${badgeClass}">${decisionText}</span>
            </h5>
            <p class="score ${data.decision}">Score: ${data.score}</p>
            <p><b>URL:</b> ${data.url || "N/A"}</p>
            <p><b>Detected Brand:</b> ${data.signals.brand_mismatch.brand || "N/A"}</p>
            <p><b>Explanation:</b> ${data.explanation || "No explanation"}</p>

            <details>
              <summary>Technical details</summary>
              <pre>${JSON.stringify(data.signals, null, 2)}</pre>
            </details>
          </div>
        </div>
      `;
    });
  </script>
</body>
</html>
